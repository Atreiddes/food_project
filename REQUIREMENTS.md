# Требования к проекту: ML сервис - Личный кабинет пользователя

## Постановка задачи

Требуется разработать Web приложение - личный кабинет пользователя ML сервиса. Подборка примеров с подобными сервисами - [ссылка](ссылка).

---

## Функциональные требования к личному кабинету

### Основной функционал

1. **Главная страница** с описанием возможностей ML сервиса

2. **Регистрация и авторизация**
   - Возможность зарегистрироваться и авторизоваться

3. **Управление балансом**
   - Возможность просматривать баланс (баланс в условных кредитах)
   - Возможность пополнять баланс через кнопку пополнить (эквайринг подключать не требуется)

4. **Работа с ML сервисом**
   - Возможность выполнить запрос к ML сервису из Web интерфейса со списанием кредитов с баланса (при условии успешного выполнения запроса)

5. **История операций**
   - Возможность просматривать историю загруженных данных и предсказаний по ним, с указанием суммы списанных кредитов

6. **REST API**
   - Возможность выполнять запросы к ML сервису с помощью REST интерфейса

7. **Валидация данных**
   - Требуется предусмотреть валидацию данных. Если в загружаемой выборке присутствуют ошибочные данные, то возвращать их пользователю, а над валидными данными производить предсказание

8. **Проверка баланса**
   - Требуется предусмотреть проверку на положительный баланс при запросах к системе

9. **Роль администратора** (опционально)
   - Роль администратор подразумевает возможность пополнять баланс пользователям (модерировать пополнения от пользователей) и просматривать все транзакции
   - Данное задание является не обязательным и в случае выполнения принесет дополнительные баллы

---

## Этапы выполнения задачи

### Этап 1: Проектирование объектной модели сервиса

**Цель:** Выделить базовые сущности с которыми будет происходить работа.

**Требования:**
- Пользователь
- ML модель
- История транзакций/предсказаний
- Задача для ML модели
- И т.д.

**Проектирование:**
- При проектировании написать названия классов, названия полей, методов, принимаемых типов данных, модификаторов доступа
- При проектировании использовать все базовые принципы ООП, а именно:
  - Инкапсуляцию
  - Наследование
  - Расширение классов
  - Полиморфизм

**Формат:** Проектирование допускается в виде написанного кода.

> **P.S.** Для надлежащего выполнения задания, вам требуется детально ознакомиться с общим заданием на курс (предыдущая страница LMS). Внимательно прочитать требования к сервису и исходя из требований проектировать вашу объектную модель.

---

### Этап 2: Подключение базы данных

**Цель:** Подключить к объектной модели приложения базу данных с использованием ORM фреймворка.

**Требования:**
- Протестировать работоспособность системы:
  - Создание пользователей
  - Пополнение баланса
  - Списание с баланса
  - История транзакций
  - И т.д.

**Подготовка:**
- Подготовить сценарий инициализации базы данных стандартными данными:
  - Демо пользователь
  - Демо администратор
  - Базовые модели доступные для работы

---

### Этап 3: Реализация интерфейсов

**Цель:** Реализовать 2 интерфейса взаимодействия с системой - REST и Telegram bot.

**REST API требования:**
- Интерфейс должен содержать весь базовый функционал системы:
  - Регистрация
  - Авторизация
  - Отправка данных для предсказания
  - Просмотр и пополнение баланса

**Telegram bot требования:**
- Интерфейс должен содержать весь базовый функционал системы:
  - Регистрация
  - Авторизация
  - Отправка данных для предсказания
  - Просмотр и пополнение баланса

---

### Этап 4: Интеграция с ML сервисом через RabbitMQ

**Цель:** Реализовать взаимодействие системы с ML сервисом посредством передачи сообщений.

**Требования:**
- Требуется развернуть несколько воркеров
- Подключить их к RabbitMQ
- Настроить RabbitMQ в режиме один издатель - несколько слушателей

**Функционал воркеров:**
- Воркеры должны получать ML задачу
- Проводить валидацию данных
- Выполнять предикт
- Сообщать результат своей работы

**Тестирование:**
- Требуется протестировать работу системы на примере Telegram bot

---

### Этап 5: Разработка Web приложения

**Цель:** Требуется разработать Web приложение, которое будет взаимодействовать с ранее построенной системой и реализует весь требуемый функционал.

**Требования:**
- Интеграция с REST API backend системы
- Реализация всего функционала из функциональных требований

---

### Этап 6: Покрытие тестами

**Цель:** Требуется покрыть ядро системы тестами.

**Что тестировать:**
- Создание пользователей
- Постановка ML задачи на выполнение
- Списание баланса
- И т.д.

---

### Этап 7: Контейнеризация

**Цель:** Требуется упаковать все элементы системы в Docker контейнер и развернуть все локально или на внешнем сервере.

---

### Этап 8: Мониторинг и нагрузочное тестирование

**Цель:** Требуется настроить систему мониторинга Web приложения, telegram bot, очередей сообщений, работоспособности системы и провести нагрузочное тестирование.

---

## Задание №1

### Спроектировать объектную модель сервиса

**Требования:**

1. Выделить базовые сущности с которыми будет происходить работа:
   - Пользователь
   - ML модель
   - История транзакций/предсказаний
   - Задача для ML модели
   - И т.д.

2. При проектировании написать:
   - Названия классов
   - Названия полей
   - Методов
   - Принимаемых типов данных
   - Модификаторов доступа

3. При проектировании использовать все базовые принципы ООП:
   - **Инкапсуляция**
   - **Наследование** для расширения классов
   - **Полиморфизм**

**Формат выполнения:** Проектирование допускается в виде написанного кода.

> **P.S.** Для надлежащего выполнения задания, вам требуется детально ознакомиться с общим заданием на курс (предыдущая страница LMS). Внимательно прочитать требования к сервису и исходя из требований проектировать вашу объектную модель.

---

## Задание №2

### Организовать структуру проекта и написать docker-compose файл

**Требования:**

Требуется организовать структуру проекта в соответствие с примером разобранном на лекции. А также написать docker-compose файл который будет удовлетворять следующим требованиям:

#### Структура сервисов:

1. **Требуется создать 4 сервиса:**
   - `app` (основное приложение)
   - `web-proxy` (nginx прокси)
   - `rabbitmq` (очередь сообщений)
   - `database` (база данных PostgreSQL)

#### Конфигурация сервиса app:

- Конфигурирование сервиса app происходит через переменные окружения - `env_file`
- Исходные файлы сервиса app подключаются через `volumes`

#### Конфигурация сервиса web-proxy:

- Сервис web-proxy создан на основе образа `Nginx`
- Сервис web-proxy зависит от сервиса app (`depends_on`)
- Сервис web-proxy пробрасывает наружу порты `80` и `443`

#### Конфигурация сервиса rabbitmq:

- Сервис rabbitmq создается на основе образа `rabbitmq`
- Сервис rabbitmq пробрасывает наружу порты `15672` и `5672`
- К сервису rabbitmq примонтирован раздел с жесткого диска к разделу `/var/lib/rabbitmq` внутри контейнера. Для сохранения очереди после перезагрузки сервиса.
- У сервиса rabbitmq установлен параметр - перезагружаться при сбоях (`restart: on-failure`)

#### Конфигурация сервиса database:

- Сервис database создан на основе образа `postgres`
- К сервису database примонтирован раздел локальной операционной системы для сохранения базы данных в случае удаления контейнера с базой

**Формат ответа:** Ссылка на merge request

---

## Задание №3

### Создать упрощённый вариант ML сервиса - Чат с рекомендациями по правильному питанию

**Требования:**

#### Общие требования:

1. **ML модель:**
   - Использовать модель Mistral из Ollama для генерации рекомендаций
   - Модель должна давать советы по правильному питанию

2. **Архитектура:**
   - Весь код должен соответствовать принципам ООП
   - Весь код должен соответствовать принципам SOLID
   - Использовать объектную модель из Задания №1 (адаптировать под текущую задачу)

3. **Функционал:**
   - Чат-интерфейс для общения с пользователем
   - Выдача рекомендаций по правильному питанию на основе запросов пользователя
   - Учёт баланса пользователя (списание кредитов за запросы)
   - История запросов и ответов

#### ⚠️ КРИТИЧЕСКИ ВАЖНО - ТРЕБОВАНИЯ ПО БЕЗОПАСНОСТИ:

**ЗАПРЕЩЕНО использовать в коде, комментариях, документации:**
- Упоминания AI, Artificial Intelligence
- Названия сервисов: Lovable, ChatGPT, Claude и любых других AI-сервисов
- Любые ссылки на автоматическую генерацию кода
- Любые упоминания использования внешних AI-инструментов

**ВСЕ упоминания должны быть заменены на:**
- "ML сервис" вместо "AI сервис"
- "ML модель" вместо "AI модель"
- "Сервис рекомендаций по питанию" вместо названий конкретных сервисов
- "Модель машинного обучения" вместо "искусственный интеллект"

**Последствия нарушения:** Отчисление студента из учебного заведения

#### Технические детали:

- Интеграция с Ollama (локальный запуск Mistral)
- REST API для взаимодействия с моделью
- Система аутентификации пользователей
- База данных для хранения истории и балансов
- Docker-compose конфигурация для всех сервисов

**Формат выполнения:** Рабочий код с соблюдением всех требований безопасности
